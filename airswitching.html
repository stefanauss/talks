<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>AirSwitching - 1 Cable (And a ½) To Rule Them All</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/stefanauss.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">

				<section>
					<h1>AirSwitching</h1>
					<h2>1 (and a ½) Cable to Rule Them All</h2>
					<h3>Ninux Day 2017 @ Bologna</h3>
					<small>Stefanauss, Lipos - Ninux Cosenza</small>
				</section>

				<section>
					<h2>Cos'è?</h2>
					<p>È Ground Routing complementato da uno:</p>
					<ul>
						<li><strong>Switch</strong> con chip dedicato, non-blocking throughput</li>
						<li><strong>Managed</strong> (in realtà è anche router, ma abbiamo già il GR)</li>
						<li><strong>PoE</strong> sia in ingresso che in  uscita (passthrough)</li>
						<li><strong>Outdoor</strong>, rugged come se non meglio delle CPE solite</li>
					</ul>
				</section>

				<section>
					<h2>Perchè?</h2>
					<ul>
						<li>Logisticamente è una vittoria</li>
						<li>0 scuse per non supernodarsi</li>
						<li>Massima espandibilità di un supernodo</li>
					</ul>
				</section>

				<section>
					<h2>Perchè non prima?</h2>
					<ul>
						<li>Perchè prima dispositivi con tutte queste feature <u>contemporanemante</u> non c'erano</li>
						<li>o costavano un occhio della testa</li>
						<li>Lo abbiamo sperimentato in un momento di <u>totale insofferenza</u> per i nodi foglia</li>
					</ul>
				</section>

				<section>
					<h2>Switch</h2>
					<ul>
						<li>Switching silicon dedicato, come su molti router OpenWrt</li>
						<li>Throughput dedicato, non condiviso come sugli OpenWrt!</li>
						<li>Wire speed, 0% load</li>
					</ul>
				</section>

				<section>
					<h2>Managed</h2>
					<ul>
						<li>Riduttivo, considerando che sono RouterOS o EdgeOS completi</li>
						<li>Supporto più feature complete delle funzionalità L2 (OpenWrt supporta veramente il minimo)</li>
						<li>Noi lo usiamo praticamente come un ali figo, ma per chi vuole fare setup astrusi c'è il mondo</li>
					</ul>
				</section>

				<section>
					<h2>PoE</h2>
					<ul>
						<li>Alimentabili via PoE, sia 2 che 4 coppie</li>
						<li>PoE passthrough su tutte le altre porte</li>
						<li>Possibilità di alimentazione alternativa in DC</li>
						<li>La potenza massima erogabile si ottiene via DC</li>
						<li>Via PoE c'è margine di tranquillità solo per 2 antenne full load</li>
					</ul>
				</section>

				<section>
					<h2>Outdoor</h2>
					<ul>
						<li>Water/Weather-proof</li>
						<li>Montaggio a palo (metal ring)</li>
					</ul>
				</section>

				<section>
					<section>
						<h2>Mikrotik Powerbox Pro</h2>
						<h3><a href="https://mikrotik.com/product/RB960PGS-PB">RB960PGS-PB (82€)</a></h3>
						<img src="https://img.routerboard.com/mimg/1298_l.jpg" style="height: 50%; width: 50%">
					</section>
					<section>
						<h2>Mikrotik Powerbox Pro</h2>
						<h3><a href="https://mikrotik.com/product/RB960PGS-PB">RB960PGS-PB (82€)</a></h3>
						<ul>
							<li>5 porte Gigabit + 1 SFP</li>
							<li>Switch QCA8337, ether1-5</li>
							<li>Range voltaggio 12-57 V</li>
							<li>@&le;30V: Corrente max per porta 1A; Corrente max totale 2A</li>
							<li>Potenza massima erogabile 60W (9W massimi device)</li>
							<li>PoE autodetect</li>
							<li>Ali + PoE injector inclusi</li>
							<li>Monitor temperatura + voltaggio</li>
						</ul>
					</section>
				</section>

				<section>
					<section>
						<h2>Mikrotik Powerbox</h2>
						<h3><a href="https://mikrotik.com/product/RB750P-PBr2">RB750P-PBr2 (53€)</a></h3>
						<img src="https://img.routerboard.com/mimg/1004_l.jpg" style="height: 50%; width: 50%">
					</section>
					<section>
						<h2>Mikrotik Powerbox</h2>
						<h3><a href="https://mikrotik.com/product/RB750P-PBr2">RB750P-PBr2 (53€)</a></h3>
						<ul>
							<li>5 porte 10/100</li>
							<li>Switch Atheros8227, ether1-5</li>
							<li>Range voltaggio 8-30 V</li>
							<li>@&le;30V: Corrente max per porta 1A; Corrente max totale 2A</li>
							<li>Potenza massima erogabile 60W (2W massimi device)</li>
							<li>No PoE autodetect</li>
							<li>Ali + PoE injector inclusi</li>
							<li>Monitor temperatura + voltaggio</li>
						</ul>
					</section>
				</section>

				<section>
					<section>
						<h2>Ubiquiti EdgePoint</h2>
						<h3><a href="https://www.ubnt.com/edgemax/edgepoint/">EP-R6 (104€)</a></h3>
						<img src="http://weblance.com.ua/uploads/posts/2016-09/1474818271_review_ubiquiti_edgepoint_ep-r6_11_anterfaces_closer.jpg" style="height: 66%; width: 66%">
					</section>
					<section>
						<h2>Ubiquiti EdgePoint</h2>
						<h3><a href="https://www.ubnt.com/edgemax/edgepoint/">EP-R6 (104€)</a></h3>
						<ul>
							<li>5 porte Gigabit + SFP</li>
							<li>Switch ?</li>
							<li>Range voltaggio 16-26V</li>
							<li>DC Terminal Block con autocorrezione polarità</li>
							<li>@&le;30V: Corrente max per porta 1A; Corrente max totale 2A</li>
							<li>Potenza massima erogabile 30W con PoE-In; 72W con DC (7W massimi device)</li>
							<li>No PoE autodetect</li>
							<li>PoE injector incluso, Ali DC a parte</li>
						</ul>
					</section>
				</section>

				<section>
					<h2>Logistica</h2>
					<ul>
						<li>Già era raro, ora l'inscatolamento sta a 0</li>
						<li>Semplificazione progetti dei supernodi, solo 1 cavo (e mezzo, la DC) da portare</li>
						<li>Sposta il fattore limitante per i supernodi dalla logistica al budget</li>
						<li>Supernodo StefanaussRoges: da impossibile a 3 antenne</li>
						<li>Supernodo Algemfeac: maggiore operatività e autonomia sul tetto e upgrade immediato da 1 a 4 antenne</li>
						<li>Ready in prospettiva "nodo autonomo".</li>
					</ul>
				</section>

				<section>
					<h2>Config Mikrotik RouterOS</h2>
					<h3>Master Port</h3>
					<ul>
						<li>RouterOS ha il concetto di <em>master port</em></li>
						<li>Una porta ethernet viene "sottratta" alla CPU/OS e resa parte dello switching group assegnandole una master port</li>
						<li>La master port è unica ed è la "porta CPU" dello switch a livello OS </li>
						<li>L'OS non vede il traffico delle altre porte dello switching group!</li>
						<li>Compaiono come "slave" (S) in RouterOS</li>
					</ul>
				</section>

				<section>
					<h2>Config Mikrotik Powerbox Pro</h2>
					<pre><code># jan/02/1970 02:05:10 by RouterOS 6.39.1
# software id = IJ69-YT55
#
### CREAZIONE SWITCHING GROUP ###
### MASTER PORT = TRUNK VS GR ###
/interface ethernet
set [ find default-name=ether2 ] master-port=ether1
set [ find default-name=ether3 ] master-port=ether1
set [ find default-name=ether4 ] master-port=ether1
#
### CREAZIONE DEI TRUNK ###
/interface ethernet switch vlan
add independent-learning=yes ports=ether1,ether2 switch=switch1 vlan-id=3
add independent-learning=yes ports=ether1,ether3 switch=switch1 vlan-id=4
add independent-learning=yes ports=ether1,ether4 switch=switch1 vlan-id=5
### switch1-cpu indispensabile per abilitare il management ###
add independent-learning=yes ports=ether1,ether2,ether3,ether4,switch1-cpu \
    switch=switch1 vlan-id=7
#
### NATIVE/UNTAGGED VLAN/PVID ###
/interface ethernet switch port
set 0 default-vlan-id=7 vlan-mode=secure
set 1 default-vlan-id=7 vlan-mode=secure
set 2 default-vlan-id=7 vlan-mode=secure
set 3 default-vlan-id=7 vlan-mode=secure
set 5 default-vlan-id=7 vlan-mode=secure
#
/ip hotspot profile
set [ find default=yes ] html-directory=flash/hotspot
/interface l2tp-server server
set caller-id-type=ip-address
/ip address
add address=192.168.1.1/24 interface=ether5 network=192.168.1.0
#
### MANAGEMENT DEL POWERBOX ###
add address=10.87.19.250/24 interface=ether1 network=10.87.19.0</code></pre>
				</section>

			<section>
				<h2>Config Mikrotik Powerbox</h2>
				<pre><code># nov/23/2017 23:38:16 by RouterOS 6.39.1
# software id = T3VQ-A2K6
#
#
### CREAZIONE SWITCHING GROUP ###
### MASTER PORT = TRUNK VS GR ###
/interface ethernet
set [ find default-name=ether2 ] master-port=ether1
# NO AUTOPOE
set [ find default-name=ether3 ] master-port=ether1 poe-out=forced-on
set [ find default-name=ether4 ] master-port=ether1
#
### CREAZIONE DEI TRUNK ###
/interface ethernet switch vlan
add ports=ether1,ether2 switch=switch1 vlan-id=3
add ports=ether3,ether4 switch=switch1 vlan-id=9
### switch1-cpu indispensabile per abilitare il management ###
add ports=ether1,ether2,switch1-cpu,ether3,ether4 switch=switch1 vlan-id=7
add ports=ether3,ether1 switch=switch1 vlan-id=4
#
### NATIVE/UNTAGGED VLAN/PVID ###
### Bug delle VLAN, 2017 Edition ###
/interface ethernet switch port
set 0 vlan-mode=secure
set 1 vlan-mode=secure
set 2 vlan-mode=secure
set 3 vlan-mode=secure
set 5 vlan-mode=secure
#
### MANAGEMENT POWERBOX ###
### Iface di tipo VLAN perchè è necessario processare traffico tagged ###
/interface vlan
add interface=ether1 name=mgmt vlan-id=7
/ip hotspot profile
set [ find default=yes ] html-directory=flash/hotspot
/interface l2tp-server server
set caller-id-type=ip-address
#
### INDIRIZZI: EMERGENZA + MGMT RINOMINATA ###
/ip address
add address=192.168.88.1/24 interface=ether5 network=192.168.88.0
add address=10.97.0.250/24 interface=mgmt network=10.97.0.0
#
### DEFAULT GATEWAY = GR ###
/ip route
add distance=1 gateway=10.97.0.1
/system clock
set time-zone-name=Europe/Rome</code></pre>
			</section>

			<section>
				<h2>RouterOS Cable Test</h2>
				<h3>Lifesaver :-)</h3>
				<img src="https://i.imgur.com/fW2kbrj.jpg">
			</section>

			<section>
				<section>
					<h2>Configurazione EdgePoint</h2>
					<img src="http://i.share.pho.to/1772b9f0_o.png">
				</section>
				<section>
					<h2>Configurazione EdgePoint</h2>
					<img src="http://i.share.pho.to/3a463647_o.png">
				</section>
				<section>
					<h2>Ubiquitume del giorno</h2>
					<ul>
						<li>Di default management su eth0. Quindi</li>
						<li>Assegna le VLAN alle altre eth e dalle allo switch</li>
						<li>Sposta la management sullo switch</li>
						<li>Loggati dalla nuova management</li>
						<li>Aggiungi VLAN su eth0 e aggiungi allo switch</li>
						<li>Profit?</li>
					</ul>
				</section>
				<section>
					<h2>PoE Selection</h2>
					<img src="http://i.share.pho.to/c53f3129_o.png">
				</section>
			</section>

			<section>
				<h1>Happy Ninux :)</h1>
			</section>

			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
